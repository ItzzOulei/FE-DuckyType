(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[204],{788:e=>{e.exports={formContainerStyling:"UpdateForm_formContainerStyling__UprU_",inputField:"UpdateForm_inputField__x3aWh",inputFieldError:"UpdateForm_inputFieldError__973nB",button:"UpdateForm_button__isjBe",buttonContainer:"UpdateForm_buttonContainer__Udj0U",deleteButton:"UpdateForm_deleteButton__MFYBi",error:"UpdateForm_error__J2_IM"}},2203:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>p});var s=a(7876),t=a(4232),o=a(9099);a(8781);var n=a(7169),i=a(8254),l=a(4301),d=a(788),c=a.n(d);function u(){let e=(0,o.useRouter)(),{id:r}=e.query,{session:a,login:d,logout:u}=(0,i.S)(),[p,m]=(0,t.useState)({username:"",email:"",password:"",passwordConfirm:"",bio:"",keyboard:""}),[h,b]=(0,t.useState)(null),[w,g]=(0,t.useState)(""),C=e=>{let{name:r,value:a}=e.target;b(e=>({...e,[r]:a})),m({...p,[r]:""})},f=e=>{let r=!0,a={username:"",email:"",password:"",passwordConfirm:"",bio:"",keyboard:""};return e.username?e.username.length<3?(a.username="Username must be at least 3 characters",r=!1):e.username.length>50&&(a.username="Username is too long (max 50 characters)",r=!1):(a.username="Username can't be empty",r=!1),e.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(e.email)?e.email.length>255&&(a.email="Email is too long (max 255 characters)",r=!1):(a.email="Please enter a valid email address",r=!1):(a.email="Email can't be empty",r=!1),e.password&&(e.password.length<5?(a.password="Password must be at least 5 characters",r=!1):e.password.length>255?(a.password="Password is too long (max 255 characters)",r=!1):/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(e.password)||(a.password="Password must contain uppercase, lowercase, and a number",r=!1),e.password!==w&&(a.passwordConfirm="Passwords must match",r=!1)),m(a),r},y=async()=>{if(!f(h))return;let a=JSON.parse(localStorage.getItem("session")),s=null==a?void 0:a.accessToken;if(!s){l.oR.error("You need to be logged in to save changes.",{transition:l.br});return}try{let{user:a,token:t}=await n.A.update(h,s);b(a);let o={accessToken:t,username:a.username,email:a.email,userId:a.id};localStorage.setItem("session",JSON.stringify(o)),d({accessToken:t}),l.oR.success("Profile updated successfully!",{transition:l.br}),e.push("/profile/".concat(r))}catch(e){l.oR.error("Failed to update profile.",{transition:l.br})}};return(0,t.useEffect)(()=>{r&&(async()=>{let a=await n.A.getUser(r),s=JSON.parse(localStorage.getItem("session"));s?parseInt(r)!==s.userId&&(e.push("/profile/".concat(r)),l.oR.error("You cant edit other profiles!",{transition:l.br})):(e.push("/profile/".concat(r)),l.oR.error("You must be logged in!",{transition:l.br})),b(a)})()},[r]),h?(0,s.jsxs)("div",{className:c().formContainerStyling,children:[(0,s.jsx)("h1",{children:"Update Profile"}),(0,s.jsxs)("div",{className:p.username?c().inputFieldError:c().inputField,children:[(0,s.jsx)("input",{onChange:C,name:"username",id:"username",value:h.username||"",placeholder:" "}),(0,s.jsx)("label",{htmlFor:"username",children:"Username"})]}),p.username&&(0,s.jsx)("p",{className:c().error,children:p.username}),(0,s.jsxs)("div",{className:p.email?c().inputFieldError:c().inputField,children:[(0,s.jsx)("input",{onChange:C,name:"email",id:"email",value:h.email||"",placeholder:" "}),(0,s.jsx)("label",{htmlFor:"email",children:"Email"})]}),p.email&&(0,s.jsx)("p",{className:c().error,children:p.email}),(0,s.jsxs)("div",{className:p.bio?c().inputFieldError:c().inputField,children:[(0,s.jsx)("textarea",{onChange:C,name:"bio",id:"bio",value:h.bio||"",placeholder:" ",rows:"4"}),(0,s.jsx)("label",{htmlFor:"bio",children:"Bio"})]}),p.bio&&(0,s.jsx)("p",{className:c().error,children:p.bio}),(0,s.jsxs)("div",{className:p.keyboard?c().inputFieldError:c().inputField,children:[(0,s.jsx)("input",{onChange:C,name:"keyboard",id:"keyboard",value:h.keyboard||"",placeholder:" "}),(0,s.jsx)("label",{htmlFor:"keyboard",children:"Keyboard"})]}),p.keyboard&&(0,s.jsx)("p",{className:c().error,children:p.keyboard}),(0,s.jsxs)("div",{className:p.password?c().inputFieldError:c().inputField,children:[(0,s.jsx)("input",{onChange:C,name:"password",id:"password",type:"password",placeholder:" "}),(0,s.jsx)("label",{htmlFor:"password",children:"New Password"})]}),p.password&&(0,s.jsx)("p",{className:c().error,children:p.password}),(0,s.jsxs)("div",{className:p.passwordConfirm?c().inputFieldError:c().inputField,children:[(0,s.jsx)("input",{onChange:e=>{g(e.target.value),m({...p,passwordConfirm:""})},name:"passwordConfirm",id:"passwordConfirm",type:"password",placeholder:" ",value:w}),(0,s.jsx)("label",{htmlFor:"passwordConfirm",children:"Confirm Password"})]}),p.passwordConfirm&&(0,s.jsx)("p",{className:c().error,children:p.passwordConfirm}),(0,s.jsx)(s.Fragment,{}),(0,s.jsxs)("div",{className:c().buttonContainer,children:[(0,s.jsx)("button",{onClick:y,className:c().button,children:"Save Changes"}),(0,s.jsx)("button",{onClick:()=>{window.confirm("Are you sure you want to delete your account?")&&n.A.deleteUser(r).then(()=>{e.push("/"),u(),l.oR.success("Your account was deleted!",{transition:l.br})}).catch(e=>{l.oR.error("Failed to delete account. Please try again.")})},className:c().button,id:c().deleteButton,children:"Delete Account"})]})]}):null}function p(){return(0,s.jsx)(u,{})}},2649:(e,r,a)=>{"use strict";function s(e){return async(r,a)=>{let s={method:e,headers:{"content-type":"application/json"},...a};null!==s.token&&(s.headers.Authorization="Bearer ".concat(s.token)),null!==s.body&&(s.body=JSON.stringify(s.body)),console.log(r,s);let t=await fetch(r,s);if(!t.ok){let e=Error("Request failed with status "+t.status);throw e.response=t,e}let o=t.headers.get("content-type");return o&&o.includes("application/json")?await t.json():await t.text()}}a.d(r,{C1:()=>l,TB:()=>o,Un:()=>i,hm:()=>t,mI:()=>n});let t=s("GET"),o=s("POST"),n=s("PUT"),i=s("DELETE"),l="https://campustype-backend.onrender.com"},4912:(e,r,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/profile/edit/[id]",function(){return a(2203)}])},7169:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});var s=a(2649);let t={login:e=>(0,s.TB)("".concat(s.C1,"/api/auth/login"),{body:e}),register:e=>(0,s.TB)("".concat(s.C1,"/api/auth/register"),{body:e}),update(e,r){let a=e.id;return(0,s.mI)("".concat(s.C1,"/api/users/").concat(a),{body:e,token:r})},getUser:e=>(0,s.hm)("".concat(s.C1,"/api/users/").concat(e)),deleteUser:e=>(0,s.Un)("".concat(s.C1,"/api/users/").concat(e))}},8781:(e,r,a)=>{"use strict";a.d(r,{A:()=>t});var s=a(2649);let t={startTest:(e,r)=>(0,s.TB)("".concat(s.C1,"/api/start-test?wordCount=").concat(e),{token:r}),saveResult:(e,r,a)=>(0,s.TB)("".concat(s.C1,"/api/results"),{body:e,token:r,headers:{"Content-Type":"application/json","Test-Token":a}}),getResults:e=>(0,s.hm)("".concat(s.C1,"/api/results/").concat(e)),getRun:e=>(0,s.hm)("".concat(s.C1,"/api/run/").concat(e)),getAllResults:e=>(0,s.hm)("".concat(s.C1,"/api/results"))}},9099:(e,r,a)=>{e.exports=a(8253)}},e=>{var r=r=>e(e.s=r);e.O(0,[636,593,792],()=>r(4912)),_N_E=e.O()}]);